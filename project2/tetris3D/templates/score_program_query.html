<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <title>成绩查询</title>
    <link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/static/css/bootstrap-theme.min.css">
    <script type="text/javascript" src="/static/js/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/static/js/d3.min.js"></script>
<style>

/*body {
  font: 10px sans-serif;
}*/

.bar rect {
  fill: steelblue;
  shape-rendering: crispEdges;
}

.bar text {
  fill: #fff;
}

.axis path, .axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

</style>

</head>
<body>
<div class="container-fluid">
    <ul class="nav nav-tabs">
      <li role="presentation"><a href="/SM/query">成绩查询</a></li>
      <li role="presentation" class="active"><a href="/SM/program_query">培养方案</a></li>
      <li role="presentation"><a href="/SM/logout">退出</a></li>
    </ul>
    <div class="row">
        <div class="col-md-10">

            <table class="table table-hover" >
                <thead>
                    <tr>
                        <th>课程代码</th>
                        <th>课程名称</th>
                        <th>学分</th>
                        <th>成绩</th>
                        <th>修读状态</th>
                    </tr>
                </thead>
                <tbody id="scoreTable">

                </tbody>
            </table>
        </div>

    </div>
</div>
<script type="text/javascript">

    d3.json('/SM/B_student_query',function(data){   // retrieve all the score information of logined student
        var values = data.map(function(d){return d.score;});
        updateTable(data);  // call funttion to update the student scores
       // updateInfo(data,values);    // call function to update its statistical information
    })

function generateIcon(status){    // generate the icons for each state of modification request
    switch(status){
        case 1:
            return '<span class="label label-success">正在修读</span>';
        case -1:
            return '<span class="label label-danger">重修</span>';
        case 0:
            return '<span class="label label-info">未修</span>';
    }
}

function updateTable(data) { // update student's transcript 
    d3.select("#scoreTable").selectAll("tr").remove();
    d3.select("#scoreTable").selectAll("tr")
        .data(data)
        .enter().append("tr")
        .html(function (d) {
        str = '';
        str += "<td>" + d.courseID + "</td>";   // 课程号
        str += "<td>" + d.courseName + "</td>";     // 课程名称
        str += "<td>" + d.credit + "</td>"; // 学分
        str += "<td>" + d.score + "</td>"; // 绩点
        str += "<td>" + generateIcon(0) + "</td>"; // 绩点
        return str;
    });
}
</script>

</body>
</html>